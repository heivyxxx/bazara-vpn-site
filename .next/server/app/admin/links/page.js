(()=>{var e={};e.id=16,e.ids=[16],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9765:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>r.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(8836),s(2029),s(5866);var a=s(3191),l=s(8716),n=s(7922),r=s.n(n),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["admin",{children:["links",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8836)),"C:\\Users\\Admin\\Desktop\\bazara-vpn-site\\src\\app\\admin\\links\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,2029)),"C:\\Users\\Admin\\Desktop\\bazara-vpn-site\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["C:\\Users\\Admin\\Desktop\\bazara-vpn-site\\src\\app\\admin\\links\\page.tsx"],x="/admin/links/page",u={require:s,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/admin/links/page",pathname:"/admin/links",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2426:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,2994,23)),Promise.resolve().then(s.t.bind(s,6114,23)),Promise.resolve().then(s.t.bind(s,9727,23)),Promise.resolve().then(s.t.bind(s,9671,23)),Promise.resolve().then(s.t.bind(s,1868,23)),Promise.resolve().then(s.t.bind(s,4759,23))},8770:(e,t,s)=>{Promise.resolve().then(s.bind(s,5375))},689:()=>{},5375:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var a=s(326),l=s(7577);let n="https://vpn.bazara.app",r=[{label:"1м+",days:30},{label:"2м+",days:60},{label:"3м+",days:90},{label:"4м+",days:120},{label:"5м+",days:150},{label:"6м+",days:180},{label:"7м+",days:210},{label:"8м+",days:240},{label:"9м+",days:270},{label:"10м+",days:300},{label:"11м+",days:330},{label:"12м+",days:360}];function i(e){return e?new Date(e).toLocaleDateString("ru-RU",{day:"numeric",month:"long",year:"numeric"}):"-"}function o(){let[e,t]=(0,l.useState)([]),[s,o]=(0,l.useState)(!0),[d,c]=(0,l.useState)("all"),[x,u]=(0,l.useState)(0),[p,m]=(0,l.useState)(""),[h,g]=(0,l.useState)(""),[b,f]=(0,l.useState)(""),[v,y]=(0,l.useState)(!1),[w,j]=(0,l.useState)(30),[N,k]=(0,l.useState)(1),[S,C]=(0,l.useState)(!1),[P,D]=(0,l.useState)([]),[_,z]=(0,l.useState)(!1),[T,A]=(0,l.useState)(!1),$=(0,l.useRef)(null),[q,M]=(0,l.useState)(!1),[O,L]=(0,l.useState)(""),[E,U]=(0,l.useState)(!1),[I,R]=(0,l.useState)(null),[G,B]=(0,l.useState)(!1);function J(){return e.filter(e=>("all"===d||e.creator===d)&&(!(x>0)||!!e.days&&!(e.days<x))&&(!b||!!(e.key?.toLowerCase().includes(b.toLowerCase())||`https://vpn.bazara.app/vless/${e.key}`.toLowerCase().includes(b.toLowerCase()))))}async function W(s){if(window.confirm("Удалить ссылку? Это действие необратимо.")){g(s);try{await fetch(`${n}/api/delete-user/${s}`,{method:"DELETE"}),t(e.filter(e=>e.key!==s))}catch(e){console.error("Ошибка при удалении:",e),alert("Ошибка при удалении ссылки")}g("")}}async function F(){if(!w||w<1||!N||N<1)return;C(!0),D([]),z(!1);let e=[];for(let t=0;t<N;++t){let t=function(e=8){let t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="";for(let a=0;a<e;++a)s+=t[Math.floor(Math.random()*t.length)];return s}(8);try{let s=await fetch("https://vpn.bazara.app/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({task_id:t,package_days:w,creator:"admin"})}),a=await s.json();a&&"ok"===a.status?e.push(`https://vpn.bazara.app/vless/${t}`):e.push("Ошибка генерации"),D([...e])}catch{e.push("Ошибка генерации"),D([...e])}}C(!1)}async function X(){U(!0),R(null),B(!0);try{let e=await fetch(`${n}/api/delete-all-users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:O})}),t=await e.json();if(200!==e.status){R({step:t.error||"Ошибка",details:null}),U(!1);return}}catch(e){R({step:"Ошибка запуска удаления",details:String(e)})}U(!1),M(!1)}return(0,l.useRef)(null),(0,a.jsxs)("main",{className:"w-full max-w-2xl mx-auto flex flex-col gap-10 py-16 px-4 items-center",children:[a.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-start",gap:4,alignSelf:"flex-start",width:"100%"},children:a.jsx("button",{onClick:()=>window.location.href="/admin",style:{background:"none",border:"none",padding:0,marginBottom:2,cursor:"pointer",outline:"none"},title:"Назад",children:a.jsx("svg",{width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"#ff8800",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round",style:{transition:"stroke 0.2s"},children:a.jsx("path",{d:"M15 18l-6-6 6-6"})})})}),a.jsx("h1",{className:"text-3xl font-extrabold text-white mb-8",children:"Все ссылки"}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full mb-8",children:[a.jsx("button",{onClick:()=>{y(!0),j(30),k(1),D([]),z(!1)},className:"flex-1 bg-gradient-to-r from-purple-500 to-orange-500 text-white font-bold rounded-xl px-6 py-4 text-lg shadow hover:scale-105 transition-transform",children:"Создать ссылку"}),a.jsx("button",{onClick:()=>{M(!0),L(""),R(null)},className:"flex-1 bg-gradient-to-r from-red-500 to-orange-500 text-white font-bold rounded-xl px-6 py-4 text-lg shadow hover:scale-105 transition-transform",children:"Удалить всех пользователей"})]}),v&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:(0,a.jsxs)("div",{className:"bg-[#232323] rounded-3xl shadow-2xl p-8 w-full max-w-xs flex flex-col items-center animate-fade-in relative",children:[a.jsx("button",{onClick:()=>y(!1),className:"absolute top-4 right-4 text-3xl text-gray-400 hover:text-orange-400 font-bold",children:"\xd7"}),a.jsx("div",{className:"text-xl font-bold text-white mb-4",children:"Создать тестовые ссылки"}),(0,a.jsxs)("div",{className:"w-full flex flex-col gap-3 mb-4",children:[a.jsx("label",{className:"text-white text-base font-semibold mb-1",children:"Срок действия (дней):"}),(0,a.jsxs)("div",{className:"flex gap-2 w-full",children:[a.jsx("input",{ref:$,type:"number",min:1,max:9999,value:w,onChange:e=>j(Number(e.target.value)),className:"flex-1 rounded-lg px-4 py-3 text-base text-white font-semibold bg-[#181818] placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-400",style:{textAlign:"center"}}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("button",{type:"button",className:"bg-[#444] text-white rounded-lg px-3 py-2 font-semibold hover:bg-orange-500 transition",onClick:e=>{e.preventDefault(),e.stopPropagation(),A(e=>!e)},children:"Месяцы ▼"}),T&&a.jsx("div",{className:"absolute left-0 top-full mt-1 bg-[#232323] border border-orange-400 rounded-xl shadow-lg z-10 w-32 max-h-64 overflow-y-auto",children:[...Array(12)].map((e,t)=>(0,a.jsxs)("button",{className:"block w-full text-left px-4 py-2 hover:bg-orange-500 hover:text-white text-white",onClick:()=>{j(30*(t+1)),setTimeout(()=>$.current&&$.current.focus(),100),A(!1)},children:[t+1," мес. (",(t+1)*30," д.)"]},t+1))})]})]}),a.jsx("label",{className:"text-white text-base font-semibold mb-1 mt-2",children:"Количество ссылок:"}),a.jsx("input",{type:"number",min:1,max:50,value:N,onChange:e=>k(Number(e.target.value)),className:"w-full rounded-lg px-4 py-3 text-base text-white font-semibold bg-[#181818] placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-400 text-center"})]}),a.jsx("button",{onClick:F,disabled:S||!w||w<1||!N||N<1,className:"w-full bg-gradient-to-r from-orange-500 to-purple-500 text-white font-bold rounded-xl px-6 py-3 text-lg shadow hover:scale-105 transition-transform mb-2 disabled:opacity-60",children:S?`Генерация... (${P.length}/${N})`:"Создать"}),P.length>0&&(0,a.jsxs)("div",{className:"w-full mt-4 flex flex-col items-center gap-2 max-h-60 overflow-y-auto",children:[P.map((e,t)=>(0,a.jsxs)("div",{className:"w-full flex gap-2 items-center mb-1",children:[a.jsx("input",{type:"text",readOnly:!0,value:e,className:"flex-1 rounded-lg px-2 py-1 text-base text-white bg-[#181818] select-all"}),a.jsx("button",{onClick:()=>{e&&navigator.clipboard.writeText(e).then(()=>{z(!0),setTimeout(()=>z(!1),1500)})},className:"bg-orange-500 text-white font-bold rounded-xl px-2 py-1 shadow hover:bg-orange-600 transition-transform",children:"Скопировать"})]},t)),_&&a.jsx("div",{className:"text-green-400 mt-2",children:"Скопировано!"})]})]})}),q&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:(0,a.jsxs)("div",{className:"bg-[#232323] rounded-3xl shadow-2xl p-8 w-full max-w-xs flex flex-col items-center animate-fade-in relative",children:[a.jsx("button",{onClick:()=>M(!1),className:"absolute top-4 right-4 text-3xl text-gray-400 hover:text-orange-400 font-bold",children:"\xd7"}),a.jsx("div",{className:"text-xl font-bold text-white mb-4",children:"Удалить всех пользователей"}),(0,a.jsxs)("div",{className:"text-red-400 text-center mb-4",children:["Это действие ",a.jsx("b",{children:"необратимо"}),"!",a.jsx("br",{}),"Все пользователи и конфиги будут удалены."]}),a.jsx("input",{type:"password",placeholder:"Введите пароль...",value:O,onChange:e=>L(e.target.value),className:"w-full rounded-lg px-4 py-3 text-base text-white font-semibold bg-[#181818] placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-orange-400 text-center mb-4",disabled:E}),a.jsx("button",{onClick:X,disabled:E||!O,className:"w-full bg-gradient-to-r from-red-500 to-orange-500 text-white font-bold rounded-xl px-6 py-3 text-lg shadow hover:scale-105 transition-transform mb-2 disabled:opacity-60",children:E?"Запуск...":"Удалить всех"}),I&&a.jsx("div",{className:"text-red-400 mt-2",children:I.step})]})}),G&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",children:(0,a.jsxs)("div",{className:"bg-[#232323] rounded-3xl shadow-2xl p-8 w-full max-w-xs flex flex-col items-center animate-fade-in relative",children:[a.jsx("button",{onClick:()=>{B(!1),R(null)},className:"absolute top-4 right-4 text-3xl text-gray-400 hover:text-orange-400 font-bold",children:"\xd7"}),a.jsx("div",{className:"text-xl font-bold text-white mb-4",children:"Прогресс удаления"}),a.jsx("div",{className:"w-full text-white text-base mb-2 min-h-[60px]",style:{whiteSpace:"pre-line"},children:I?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{children:I.step}),I.details&&a.jsx("div",{className:"text-orange-400 text-xs mt-2",children:I.details})]}):"Ожидание..."}),I&&I.step&&I.step.includes("завершено")&&a.jsx("button",{onClick:()=>B(!1),className:"w-full bg-gradient-to-r from-orange-500 to-purple-500 text-white font-bold rounded-xl px-6 py-3 text-lg shadow hover:scale-105 transition-transform mt-4",children:"Закрыть"})]})}),a.jsx("input",{type:"text",value:b,onChange:e=>f(e.target.value),placeholder:"Поиск по ссылке или ключу...",className:"w-full mb-6 rounded-xl px-4 py-2 text-lg font-semibold bg-[#181818] text-white border border-orange-400 focus:outline-none focus:ring-2 focus:ring-orange-400"}),(0,a.jsxs)("div",{className:"flex gap-4 mb-8 w-full justify-center",children:[(0,a.jsxs)("select",{value:d,onChange:e=>c(e.target.value),className:"rounded-xl px-4 py-2 text-lg font-semibold bg-[#181818] text-white border border-orange-400",children:[a.jsx("option",{value:"all",children:"Все"}),a.jsx("option",{value:"admin",children:"Админ"}),a.jsx("option",{value:"user",children:"Юзер"})]}),(0,a.jsxs)("select",{value:x,onChange:e=>u(Number(e.target.value)),className:"rounded-xl px-4 py-2 text-lg font-semibold bg-[#181818] text-white border border-orange-400",children:[a.jsx("option",{value:0,children:"Любой срок"}),r.map(e=>a.jsx("option",{value:e.days,children:e.label},e.days))]})]}),s?a.jsx("div",{className:"text-lg text-gray-300",children:"Загрузка..."}):0===J().length?a.jsx("div",{className:"text-lg text-gray-400",children:"Нет ссылок по выбранным фильтрам."}):a.jsx("div",{className:"w-full flex flex-col gap-6",children:J().map((e,t)=>{var s;let l=e.createdAt?new Date(e.createdAt):null,n=l&&e.days?new Date(l.getTime()+864e5*e.days):null,r=n?(s=n.toISOString())?new Date<new Date(s)?{text:"Активна",color:"#22d37b"}:{text:"Истекла",color:"#ff4444"}:{text:"Неизвестно",color:"#888888"}:{text:"-",color:"#aaa"},o=e.key||`unknown-${t}`;return(0,a.jsxs)("div",{className:"bg-[#232323] rounded-2xl shadow-xl px-6 py-5 flex flex-col gap-2 border border-[#333] relative",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsxs)("span",{className:"text-2xl select-all font-mono text-white break-all flex-1",children:["https://vpn.bazara.app/vless/",o]}),a.jsx("span",{title:"admin"===e.creator?"Админ":"Юзер",className:"ml-2 text-2xl",children:"admin"===e.creator?"\uD83D\uDC51":"\uD83D\uDC64"}),a.jsx("button",{onClick:()=>(function(e){navigator.clipboard.writeText(e).then(()=>{m(e),setTimeout(()=>m(""),1500)})})(`https://vpn.bazara.app/vless/${o}`),className:"ml-2 bg-gradient-to-r from-orange-500 to-purple-500 text-white font-bold rounded-xl px-3 py-1 shadow hover:scale-105 transition-transform text-base",children:"Копировать"}),p===`https://vpn.bazara.app/vless/${o}`&&a.jsx("span",{className:"text-green-400 ml-2",children:"Скопировано!"}),a.jsx("button",{onClick:()=>W(o),disabled:h===o,className:"ml-2 bg-[#2c2c2c] text-red-400 rounded-xl px-2 py-1 shadow hover:bg-red-600 hover:text-white transition-transform text-base disabled:opacity-60",children:a.jsx("svg",{width:"20",height:"20",fill:"none",viewBox:"0 0 24 24",children:a.jsx("path",{stroke:"currentColor",strokeWidth:"2",d:"M6 6l12 12M6 18L18 6"})})})]}),(0,a.jsxs)("div",{className:"text-lg space-y-1",children:[(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Создано:"})," ",l?i(l.toISOString()):"-"]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Период:"})," ",e.days?`${e.days} дней`:"-"]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Истекает:"})," ",n?i(n.toISOString()):"-"]}),(0,a.jsxs)("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Осталось:"})," ",n?function(e){if(!e)return"-";let t=new Date,s=Math.ceil((new Date(e).getTime()-t.getTime())/864e5);return s<0?"Истекла":`${s} дн.`}(n.toISOString()):"-"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-500",children:"Статус:"})," ",(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[a.jsx("span",{style:{background:r.color,borderRadius:"50%",width:10,height:10,display:"inline-block"}})," ",a.jsx("span",{style:{color:r.color},children:r.text})]})]})]})]},o)})})]})}},8836:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>r,__esModule:()=>n,default:()=>i});var a=s(8570);let l=(0,a.createProxy)(String.raw`C:\Users\Admin\Desktop\bazara-vpn-site\src\app\admin\links\page.tsx`),{__esModule:n,$$typeof:r}=l;l.default;let i=(0,a.createProxy)(String.raw`C:\Users\Admin\Desktop\bazara-vpn-site\src\app\admin\links\page.tsx#default`)},2029:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(9510);function l({children:e}){return a.jsx("html",{lang:"ru",className:"dark",children:a.jsx("body",{className:"bg-dark text-white font-sans min-h-screen",children:e})})}s(5023)},5023:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[948,471],()=>s(9765));module.exports=a})();